<% if @translated_text.is_a?(String) %>
  $textarea = $('.localization_row[data-id="<%= @target_localization.id %>"] textarea');
  valFun = $textarea.is(':visible') ? 'val' : 'jqteVal';
  $textarea[valFun]("<%= j @translated_text.html_safe %>");
<% elsif @translated_text.is_a?(Array) %>
  $inputs = $('.localization_row[data-id="<%= @target_localization.id %>"] input[type=text]');
  var translated_elements = JSON.parse("<%= j @translated_text.to_json.html_safe %>");
  for (i in $inputs.toArray()) {
    $input = $($inputs[i]);
    $input.val(translated_elements[i]);
  }
<% elsif @error_message.present? %>
  alert("<%= j @error_message %>")
<% else %>
  alert("An unknown error has occurred while translating.")
<% end %>
