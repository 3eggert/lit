{"version":3,"sources":["src/lit/backend/localizations.js","src/lit/backend/sources.js","src/lit/backend/ui.js","src/lit/utils.js"],"names":["edited_rows","document","addEventListener","localizationRows","querySelectorAll","forEach","row","tdElem","e","currentTarget","parseInt","dataset","editing","id","innerHTML","rowElem","querySelector","edit","fetch","then","resp","json","html","isHtmlKey","focus","click","url","target","action","method","headers","Rails","csrfToken","body","JSON","stringify","localization","translated_value","value","localizationId","parentElement","classList","remove","checked","preventDefault","handleCloudTranslationLinkClick","href","translatedText","textareaElem","pellElement","content","inputElems","inputElem","i","link","allLocalizationRows","matches","localName","refElem","Utils","closest","localizationVersionsRows","add","td","localizationKeyRows","textarea","pell","init","element","defaultParagraphSeparator","onChange","style","display","requestInfoRow","contains","loadingElement","updateFunc","sourceIdElement","sourceId","ok","Promise","reject","status","sync_complete","clearInterval","interval","location","reload","catch","error","window","setInterval","tableElem","button","alert","confirm","acceptButtons","rejectButtons","console","log","_dropdownOpen","toggle","dropdown","selector","parentNode"],"mappings":"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","file":"app/assets/javascripts/lit/app.js","sourcesContent":["import pell from 'pell';\nimport Utils from '../utils';\n\nlet edited_rows = {};\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const localizationRows = document.querySelectorAll('td.localization_row[data-editing=\"0\"]');\n\n  localizationRows.forEach(row => {\n    row.addEventListener('click', e => {\n      const tdElem = e.currentTarget;\n      if (!parseInt(tdElem.dataset.editing)) {\n        edited_rows[tdElem.dataset.id] = tdElem.innerHTML;\n        const rowElem = document.querySelector(`td.localization_row[data-id=\"${tdElem.dataset.id}\"]`);\n        if (!parseInt(tdElem.dataset.editing) && tdElem.dataset.edit) {\n          tdElem.dataset.editing = '1';\n          fetch(tdElem.dataset.edit)\n            .then(resp => resp.json())\n            .then(({ html, isHtmlKey }) => {\n              rowElem.dataset.editing = 1;\n              rowElem.innerHTML = html;\n              rowElem.querySelector('textarea, input').focus();\n              if (isHtmlKey) {\n                rowElem.querySelector('.wysiwyg_switch').click()\n              }\n\n              rowElem.querySelector('form').addEventListener('submit', e => {\n                const url = e.target.action;\n                fetch(url, {\n                  method: 'PATCH',\n                  headers: {\n                    'X-CSRF-Token': Rails.csrfToken(),\n                    'Content-Type': 'application/json'\n                  },\n                  body: JSON.stringify({\n                    localization: {\n                      translated_value: rowElem.querySelector('textarea').value\n                    }\n                  })\n                })\n                  .then(resp => resp.json())\n                  .then(({ localizationId, html }) => {\n                    delete rowElem.dataset.editing;\n                    rowElem.innerHTML = html;\n                    rowElem.parentElement.querySelector('.show_prev_versions').classList.remove('hidden');\n                    document.querySelector(`a.change_completed_${localizationId} input[type=\"checkbox\"]`).checked = true;\n                  })\n                e.preventDefault();\n              });\n\n              const handleCloudTranslationLinkClick = e => {\n                e.preventDefault();\n                const url = e.target.href;\n                fetch(url).then(resp => resp.json()).then(\n                  ({ translatedText }) => {\n                    if (typeof (translatedText) === 'string') {\n                      const textareaElem = rowElem.querySelector('textarea');\n                      textareaElem.value = translatedText;\n                      if (isHtmlKey) {\n                        const pellElement = rowElem.querySelector('.pell');\n                        pellElement.content.innerHTML = translatedText;\n                      }\n                    } else if (typeof (translatedText) === 'object') {\n                      const inputElems = rowElem.querySelectorAll('input[type=\"text\"]');\n                      inputElems.forEach((inputElem, i) => inputElem.value = translatedText[i]);\n                    }\n                  }\n                );\n              }\n\n              rowElem.querySelectorAll('.js-cloud-translation-link').forEach(link => {\n                link.addEventListener('click', handleCloudTranslationLinkClick);\n              });\n            });\n        }\n      }\n    })\n  });\n\n  const allLocalizationRows = document.querySelectorAll('td.localization_row');\n\n  allLocalizationRows.forEach(row => {\n    row.addEventListener('click', e => {\n      if (e.target.matches('form button.cancel')) {\n        if (e.target.localName === 'button') {\n          const refElem = Utils.closest(e.target, 'td.localization_row');\n          refElem.dataset.editing = '0';\n          refElem.innerHTML = edited_rows[refElem.dataset.id];\n          e.preventDefault();\n          return false;\n        }\n      }\n    })\n  });\n\n  const localizationVersionsRows = document.querySelectorAll('tr.localization_versions_row');\n\n  localizationVersionsRows.forEach(row => {\n    row.addEventListener('click', e => {\n      if (e.target.matches('.close_versions')) {\n        const refElem = Utils.closest(e.target, 'tr.localization_versions_row');\n        refElem.classList.add('hidden');\n        refElem.querySelectorAll('td').forEach(td => td.innerHTML = '');\n      }\n    })\n  });\n\n  const localizationKeyRows = document.querySelectorAll('tr.localization_key_row');\n\n  localizationKeyRows.forEach(row => {\n    row.addEventListener('click', e => {\n      if (e.target.matches('input.wysiwyg_switch')) {\n        const refElem = Utils.closest(e.target, 'form');\n        const textarea = refElem.querySelector('textarea');\n        const pellElement = refElem.querySelector('.pell');\n\n        if (e.target.checked) {\n          if (!pellElement.content) {\n            pell.init({\n              element: pellElement,\n              defaultParagraphSeparator: '',\n              onChange: html => textarea.value = html\n            });\n          }\n\n          pellElement.content.innerHTML = textarea.value;\n          textarea.style.display = 'none';\n          pellElement.style.display = '';\n        } else {\n          textarea.style.display = '';\n          pellElement.style.display = 'none';\n        }\n      }\n\n      if (e.target.matches('.request_info_link')) {\n        const refElem = Utils.closest(e.target, 'tr.localization_key_row');\n        requestInfoRow = refElem.querySelector('.request_info_row');\n        if (requestInfoRow.classList.contains('hidden')) {\n          requestInfoRow.classList.remove('hidden');\n        } else {\n          requestInfoRow.classList.add('hidden');\n        }\n      }\n    });\n  });\n})","document.addEventListener('DOMContentLoaded', () => {\n  const loadingElement = document.querySelector('.loading');\n\n  const updateFunc = () => {\n    const sourceIdElement = document.querySelector('#source_id');\n    if (!sourceIdElement) { return; }\n\n    const sourceId = sourceIdElement.value;\n\n    fetch(`/lit/sources/${sourceId}/sync_complete`)\n      .then(resp => {\n        if (resp.ok) {\n          return resp.json();\n        } else {\n          return Promise.reject({ status: resp.status });\n        }\n      })\n      .then(json => {\n        if (json.sync_complete) {\n          loadingElement.classList.add('loaded');\n          loadingElement.classList.remove('loading');\n          clearInterval(interval);\n          location.reload();\n        }\n      })\n      .catch(error => {\n        switch (error.status) {\n          case 404:\n            loadingElement.innerHTML = 'Could not update synchronization status, please try refreshing page';\n            break;\n          case 401:\n            loadingElement.innerHTML = 'You are not authorized. Please check if you are properly logged in';\n            break;\n          case 500:\n            loadingElement.innerHTML = 'Something went wrong, please try synchronizing again';\n            break;\n          default:\n            loadingElement.innerHTML = 'An unknown error occurred. Please try again'\n        }\n        clearInterval(interval);\n      });\n  }\n\n  if (loadingElement) {\n    window.interval = setInterval(updateFunc, 500);\n  }\n\n  const tableElem = document.querySelector('.incomming-localizations-table');\n\n  tableElem && tableElem.addEventListener('click', e => {\n    const button = e.target;\n    if (button.matches('.js-accept-btn')) {\n      e.preventDefault();\n      const url = e.target.href;\n      fetch(url, {\n        method: 'GET',\n        headers: {\n          'X-CSRF-Token': Rails.csrfToken(),\n          'Content-Type': 'application/json'\n        }\n      })\n        .then(({ ok }) => {\n          if (ok) {\n            button.parentElement.parentElement.remove(); // remove row\n          } else {\n            alert('Localization could not be accepted.');\n          }\n        })\n    }\n\n    if (button.matches('.js-reject-btn')) {\n      e.preventDefault();\n      if (confirm(\"Are you sure?\")) {\n        const url = e.target.href;\n        fetch(url, {\n          method: 'DELETE',\n          headers: {\n            'X-CSRF-Token': Rails.csrfToken(),\n            'Content-Type': 'application/json'\n          }\n        })\n          .then(({ ok }) => {\n            if (ok) {\n              button.parentElement.parentElement.remove(); // remove row\n            } else {\n              alert('Localization could not be rejected.');\n            }\n          })\n      }\n    }\n  });\n\n  const acceptButtons = document.querySelectorAll('.js-accept-btn');\n  const rejectButtons = document.querySelectorAll('.js-reject-btn');\n})","document.addEventListener('click', e => {\n  console.log(e.target);\n  if (e.target.matches('[data-toggle=\"dropdown\"]')) {\n    document._dropdownOpen = true;\n    e.target.parentElement.classList.toggle('open');\n  } else {\n    document._dropdownOpen && document.querySelectorAll('.dropdown.open, .btn-group.open').forEach(dropdown => dropdown.classList.remove('open'));\n    document._dropdownOpen = false;\n  }\n});","const Utils = {\n  closest: (refElem, selector) => {\n    while (!refElem.matches(selector)) {\n      refElem = refElem.parentNode;\n      if (!refElem) { return; }\n    }\n    return refElem;\n  }\n}\n\nexport default Utils;"]}